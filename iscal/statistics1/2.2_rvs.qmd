---
title: "Random Variables"
subtitle: "Statistics I"
author: "Paulo Fagandini"
institute: "Lisbon Accounting and Business School – Polytechnic University of Lisbon"
format: 
  revealjs:
    theme: default
    slide-number: true
    cross-ref: true
    incremental: true
    math: 
      method: mathjax
    transition: slide
    footer: "Statistics I"
    from: markdown+emoji
    code-block-font-size: 0.75em
    progress: true
    css: [Exercises/webex.css]
    include-after-body: [Exercises/webex.js]
    embed-resources: true
editor: source
execute:
  enabled: true
engine: knitr
---

```{r}
library(lubridate)
library(webexercises)
```
## Disclaimer

These slides are a free translation and adaptation from the slide deck for Estatística I by Prof. Sandra Gancho Custódio from the Lisbon Accounting and Business School - Polytechnical University of Lisbon.

# (Single) Random Variables

## Random Variables

A random variable is a function that will allow us to quantify (transform into a number) each outcome.

::: {.callout}

## Random Variable

A **random variable (r.v.)** $X$ is a function $f:\Omega\rightarrow \Omega_X\subset \mathbb{R}$. $\Omega_X$ is known as the support of the r.v. $X$.

$$\omega\in\Omega \overset{X}{\rightarrow} X(\omega)\in\Omega_X\subset\mathbb{R}$$

> $X(\omega)$ is the *image* under $X$ of the outcome $\omega$
:::

Summarizing, a r.v. is a function that associates a real number to each outcome from $\Omega$.

## Random Variables

* $\{X=x\}$, $\{X\leq x\}$, $\{X>x\}$ are events
* $\{X=x\}$ happens when, from our experiment, we obtain $\omega$ such that $X(\omega)=x$. $\{X=x\}=\{\omega\in\Omega | X(\omega)=x\}$
* The probability of $X\leq x$ for example, is then $$P(X\leq x)=P\left(\{\omega\in \Omega| X(\omega)\leq x\}\right)$$

# Types of random variables

## Discrete Random Variable

$X$ is a discrete r.v. when:

* The support of $X$, $\Omega_X$, is finite or countable infinite.
* $P(\Omega_X)=1$

. . .

> In this case, $\Omega_X=\{x_1, x_2, ... , x_n\}$ with $n\in\mathbb{N}$ if $\Omega_X$ is finite, and $\Omega_X=\{x_1,x_2,...,x_n,...\}$ if it is countable infinite.

## Probability density function (*pdf*)

Let $X$ be a discrete r.v. The *pdf* of $X$ is a function $f_X:\mathbb{R}\rightarrow\mathbb{R}$ such that:

$$f_X(x)=\left\{\begin{array}{cc}P(X=x) & ,\text{ if } x\in\Omega_X\\ 0 & ,\text{ if } x\in\mathbb{R}\setminus\Omega_X\end{array}\right.$$

Naturally, by construction the *pdf* satisfies the following properties:

<table>
  <tr>
    <td style="border: none;"> $f_X(x)\geq 0 \quad \forall x\in\mathbb{R}$ </td>
  </tr>
  <tr>
    <td style="border: none;"> $\sum_{x_i\in\Omega_X}P(X=x_i)=1$ </td>
  </tr>
</table>

## Probability density function (*pdf*)

The *pdf* gives the probability in a single *point*. The total probability is distributed among single points, $x_i$. A reasonable representation of a *pdf* of a discrete r.v. could be:

| $x$ | $x_1$ | $x_2$| ... | $x_n$ | ... |
| :---: | :---: | :---: | :---: | :---: | :---: |
|$f(x)$ | $p_1$ | $p_2$ | ... | $p_n$ | ... |

Where $p_i=P(X=x_i)$

## Example

Consider the discrete r.v. $X$ with the following *pdf*:

| $x$ | 0 | 1 | 2 | 3 | 4 |
| :---: | :---: | :---: | :---: | :---: | :---: |
|$f(x)$ | $0.05$ | $a$ | $0.35$| $0.25$| $0.05$|

We could define:

* Support of $X$: $\Omega_X=\{0,1,2,3,4\}$
* $\sum_{x\in\Omega_X} f(x)=1 \Rightarrow 0.05 + a + 0.35 + 0.25 + 0.05 = 1$ that is $a=$
* 0.3

## Example

Our table is now:

| $x$ | 0 | 1 | 2 | 3 | 4 |
| :---: | :---: | :---: | :---: | :---: | :---: |
|$f(x)$ | $0.05$ | $0.3$ | $0.35$| $0.25$| $0.05$|

What is $P(X=2|X\leq 3)$?

. . .

$$P(X=2|X\leq 3)=\frac{P(X=2 \cap X\leq 3)}{P(X\leq 3)}= \frac{P(X=2)}{P(X\leq 3)}$$

. . .

$$= \frac{f(2)}{f(0)+...+f(3)}=\frac{0.35}{0.95}=`r round(.35/.95,3)`$$

## Continuous random variables

$X$  is a continuous r.v. if:

* The support of $X$, $\Omega_X$ is uncountable infinite.
* $P(\Omega_X)=1$
* $P(X=x)=0$ $\forall x\in\mathbb{R}$.

## Probability density function (*pdf*)

Let $X$ a continuous r.v.

There is a function $f_X:\mathbb{R}\rightarrow\mathbb{R}$, the *pdf* of $X$ such that:

* $f_X(x)=0$, $\forall x\in\mathbb{R}$
* $\int_{-\infty}^{\infty}f_X(x)dx=1$

## Probability density function (*pdf*)

Note that this *pdf* allows to compute the probability of events $x\in(a,b]$:

$$P(a<X\leq b)=\int_a^b f_X(x)dx$$

Observe that if you would do $X=a$ you would get the integral from $a$ to $a$, which makes $dx=0$ and therefore the integral (and the probability) becomes 0.

## Example

Let $X$ be a continuous r.v. with the following *pdf*:

$$
f(x)=\left\{\begin{array}{cc}
\theta x^2 & , 0\leq x< 1\\ 0 & ,\mathbb{R}\setminus [0,1)
\end{array}\right.
$$

* Support for $X$: $\Omega_X=[0,1)$
* $$\int_{-\infty}^{\infty}f(x)dx=1\Leftrightarrow\int_0^1\theta x^2dx=\left[\theta\frac{x^3}{3}\right]_{0}^1$$

* $$\theta\frac{1}{3}-\theta\frac{0}{3}=1\Leftrightarrow \theta=3$$

## Cumulative distribution function (*cdf*)

Let $X$ be a r.v. The **distribution function** $F_X:\mathbb{R}\rightarrow[0,1]$, defined as:

$$F_X(x)=P(X\leq x)$$

$F_x$ is unique.

## Cumulative distribution function (*cdf*)

With a discrete r.v.

| $x$ | 0 | 1 | 2 | 3 | 4 |
| :---: | :---: | :---: | :---: | :---: | :---: |
|$f(x)$ | $0.05$ | $0.3$ | $0.35$| $0.25$| $0.05$|

$$F(x)=P(X\leq x)=\left\{
  \begin{array}{cc}
    0 & x<0 \\
    0.05 & 0\leq x < 1 \\
    0.05 + 0.3 = 0.35 & 1 \leq x < 2 \\
    0.35 + 0.35 = .7 & 2 \leq x < 3 \\
    0.7 + 0.25 = .95 & 3 \leq x  < 4 \\
    1 & x\geq 4
  \end{array}
\right.$$

## Cumulative distribution function (*cdf*)

Let's revisit our previous example:

$$P(X=2|X\leq 3)=
  \frac{P(X=2)}{P(X=3)}=$$
$$\frac{F(2)-F(2^-)}{F(3)}=
  \frac{0.7-0.35}{0.95}=0.368
$$

## Cumulative distribution function (*cdf*)

With a continuous r.v.:

$$F_X(x)=P(X\leq x)=\int_{-\infty}^{x} f_X(x)dx$$

The distribution function, $F_X$ allows to compute the probability of $\{X\in(a,b]\}$

$$P(a<X\leq b)=\int_a^b f_X(x)dx=F_X(b)-F_X(a)$$

## Example 

```{r}
# Load necessary package
library(ggplot2)

# Create a sequence of x values
x <- seq(-4, 4, length.out = 1000)
y <- dnorm(x)

# Create a data frame
df <- data.frame(x = x, y = y)

# Define the shaded region
df$shade <- ifelse(df$x >= -0.2 & df$x <= 0.5, df$y, NA)

# Plot

ggplot(df, aes(x = x, y = y)) +
  geom_line(color = "blue") +
  geom_area(aes(y = shade), fill = "skyblue", alpha = 0.5) +
  annotate("text", x = -0.2, y = 0.02, label = "a", color = "black", size = 7) +
  annotate("text", x = 0.5, y = 0.02, label = "b", color = "black", size = 7) +
  annotate("text", x = 0.35, y = 0.1, label = expression(P(a < x ~ "\u2264" ~ b)), size = 5) +
  labs(title = "Standard Normal Distribution",
       x = "x", y = "Density") +
  theme_minimal()

```

## Example

Consider the continuous r.v. defined previously, with the *pdf*:

$$
  f(x)=\left\{
    \begin{array}{cc}
      3x^2 & , 0\leq x< 1\\
      0 & , \mathbb{R}\setminus [0,1)
    \end{array}
  \right.
$$

Support for $X$: $\Omega_X=[0,1)$

Distribution function (*cdf*):

$$
  F(x)=P(X\leq x) = \int_{-\infty}^x f(t)dt = \left\{
    \begin{array}{cc}
      0 & , x<0\\
      x^2 & ,0\leq x<1 \\
      1& ,x\geq 1
    \end{array}
  \right.
$$

## Properties of the *cdf*

Nonetheless the r.v. is discrete or continuous, $F_X$ has the following properties:

* $F_X:\mathbb{R}\rightarrow[0,1]$
* $F_X$ is continuous from the right: $\lim_{x\rightarrow a^+}F_X(x)=F(a)$
* $F_X$ is monotone non-decreasing.
* $\lim_{x\rightarrow -\infty} F_X(x)=0$
* $\lim_{x\rightarrow \infty} F_X(x)=1$