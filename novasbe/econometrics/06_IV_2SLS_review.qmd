---
title: "Review for lecture 2SLS"
format: html
---

## 2SLS

Suppose you have the following model

$$
    y = X\beta + u
$$

The problem is that we have endogeneity, *i.e.* $E[X'u]\neq 0$. This will give as a biased and inconsistent $\beta_{OLS}$ estimator.

$$
\hat{\beta}=(X'X)^{-1}X'y=(X'X)^{-1}X'(X\beta+u)=\beta+\underbrace{(X'X)^{-1}X'u}_{\neq 0}\neq \beta
$$

Assume there is a variable $Z$ such that:

1. $rank(E[Z'X])=k$, this is, $Z$ is relevant, it is correlated with $X$
2. $E[Z'u]=0$, this is, $Z$ is exogeneous.

$Z$ is what we will call the instrument.

Let's predict $X$ using this instrument. If we regress

$$X=Z\gamma + \epsilon$$

we get

$$
    \hat{\gamma}=(Z'Z)^{-1}Z'X
$$

And because $\hat{X}=Z\hat{\gamma}=Z(Z'Z)^{-1}Z'X$. Note that $Z(Z'Z)^{-1}Z'$ is the projection matrix $P_Z$, so $P_Z X$ is the part of $X$ that can be explained with the variable $Z$.

Now let's regress

$$
    y = \hat{X}\beta_{2SLS} + u
$$

From where we get:

$$
    \hat{\beta}_{2SLS}=(\hat{X}'\hat{X})^{-1}\hat{X}'y
$$

Replace $\hat{X}=P_ZX$

$$
    \hat{\beta}_{2SLS}=\left((P_ZX)'P_ZX\right)^{-1}(P_ZX)'y = \left(X'P_Z'P_ZX\right)^{-1}X'P_Z'y
$$

Note now that $P_Z'=P_Z$ and further, that $P_Z^2=P_Z$, we get:

$$
    \hat{\beta}_{2SLS}=\left(X'P_ZX\right)^{-1}X'P_Z'y
$$

Why this helps?

$$
\begin{aligned}
    E[\hat{\beta}_{2SLS}|Z]=&E\left[\left(X'P_ZX\right)^{-1}X'P_Z'(X\beta+u)|Z\right]\\
    =&E\left[\left(X'P_ZX\right)^{-1}X'P_Z'X\beta+\left(X'P_ZX\right)^{-1}X'P_Z'u|Z\right]\\
    =&E\left[\beta+\left(X'P_ZX\right)^{-1}X'Z(Z'Z)^{-1}\underbrace{Z'u}_{=0}|Z\right]=\beta
\end{aligned}
$$